<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
<link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.blue-amber.min.css" />
<link rel="stylesheet" href="w3.css" />
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<link href="https://fonts.googleapis.com/css?family=Bree+Serif" rel="stylesheet">


</head>

<style>

.search_menu
{
   
   height:80px;
   
   background-color:#D32F2F;
   
}

.footer{
    position: fixed;
    bottom: 0;
	width:100%;
	height:80px;
	background-color:#D32F2F;
}

.items_appended
{

   padding:10px;
   margin-top:20px;
   margin-bottom:20px;
   background-color:#D32F2F;
   box-shadow:7px 7px 5px #888888;
}


</style>

<body onload="calculate_items();empty_if_null()">

<div class="container-fluid">





<div class="row search_menu">
<div class="col-xs-2" style="padding:5%">
 
 <div class="w3-dropdown-hover">
    <div class="w3-button" style="background-color:#D32F2F" onclick="show_user_info()"><i class="material-icons">reorder</i></div>
    <div class="w3-dropdown-content w3-bar-block w3-border">
	  <a  class="w3-bar-item w3-button" id="user_name" style="text-align:center"></a>
	  <a  class="w3-bar-item w3-button" id="user_height" style="text-align:center"></a>
	  <a  class="w3-bar-item w3-button" id="user_weight" style="text-align:center"> </a>
	  <a  class="w3-bar-item w3-button" id="user_goal" style="text-align:center"></a>
      <a href="user_info.html" class="w3-bar-item w3-button">Update user info</a>
      <a href="goal.html" class="w3-bar-item w3-button">Update goal</a>
      
    </div>
  </div>
 
 
 
</div>
<div class="col-xs-8">
<div class="row" style="padding:5%">
<div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable col-xs-8">
    <label class="mdl-button mdl-js-button mdl-button--icon" for="item_name">
      <i class="material-icons">search</i>
    </label>
    <div class="mdl-textfield__expandable-holder">
      <input class="mdl-textfield__input" type="text" id="item_name" placeholder="Enter what you ate">
      <label class="mdl-textfield__label" for="sample-expandable">Expandable Input</label>
    </div>
</div>

<div class="col-xs-4" >
   <button class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored" style="margin:auto" onclick="itemDesc()" >
   <i class="material-icons">add</i>
   </button>
</div>
</div>
  
</div>    
    


<div class="col-xs-2" style="padding-top:8%">

<div class="material-icons mdl-badge mdl-badge--overlap" id="total_items" data-badge="1" >room_service</div>

<!--
<button id="demo-menu-lower-right" class="mdl-button mdl-js-button mdl-button--icon" style="margin-top:auto">
  <i class="material-icons">more_vert</i>
</button>

<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect"
    for="demo-menu-lower-right">
  <li class="mdl-menu__item">Some Action</li>
  <li class="mdl-menu__item">Another Action</li>
  <li disabled class="mdl-menu__item">Disabled Action</li>
  <li class="mdl-menu__item">Yet Another Action</li>
</ul>
-->
</div>
</div>

<div id="items">



</div>



</div>
<div class="footer">

 
 <div class="row">
    <div class="col-xs-2">
    </div>	
    <div class="col-xs-8">
	<div class="row" style="padding:5%">
        
		<div class="col-xs-8">
		<button class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored" style="margin:auto" onclick = "clear_data()" >
        <i class="material-icons">delete</i>
        </button>
		</div>

	<!--</div>-->
	
	    <div class="col-xs-4">
	    <button class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored" style="margin:auto" onclick="get_total()" >
        <p class="material-icons">arrow_forward</p>
        </button>
	    </div>
	
	</div>
	</div>
    <div class="col-xs-2">
    </div>
    </div>	
 </div>
 
 <script>


 
 /*function get_total()
 {
   window.open("content.html",'_self');
 }
 
 function clear_data()
 {
    var test = localStorage.removeItem('added-items');
	alert("your inventry has been emptied!!");
	calculate_items();
 } 


 var fooditems = new Array();
 
 
 
 function itemDesc()
{
     document.getElementById("items").innerHTML = ""; 
     //alert("in function");
     var xhttp = new XMLHttpRequest();
     xhttp.onreadystatechange = function() {
     //alert("inside call");
	 //alert(this.status);
	 if (this.readyState == 4 && this.status == 200) {
      //alert(str[0].Protein);
	  
	 var str = JSON.parse(this.responseText);
	 alert(document.getElementById("item_name").value);
     var patt = new RegExp(document.getElementById("item_name").value);
     var id_item=0;
	 //var r = document.createElement("div");
     //r.id = "container";
      for(var i=0;i<str.length;i++)
	  {
	   var res = patt.test(str[i].Description);
	   //alert(res);
	   
	   if(res)
	   {
	     
          var y = document.createElement("div");
		  y.className = "items_appended";
		  y.innerHTML = str[i].Description;
		  y.setAttribute("item_id",id_item++);
		  y.setAttribute("item_description",str[i].Description);
		  y.setAttribute("item_Protein",str[i].Protein);
		  y.setAttribute("item_carbohydrate",str[i].Carbohydrate);
		  y.onclick = getName;
		  
		  
		  //r.appendChild(y);
		  //document.getElementById("items").appendChild(y)
		  
		  //document.getElementById("items_appended_id").appendChild(y); 
		  document.getElementById("items").appendChild(y);
		  
		  
		}
		
	  }
	  //alert(document.getElementById("items").innerHTML);
    }
  };
  xhttp.open("GET", "fooditems.json", true);
  xhttp.send();
}
    function getName()
   {
   //alert(this.getAttribute("item_id"));
   //alert(this.getAttribute("item_description"));
   var x = {
            Id:this.getAttribute("item_id"),
            Description:this.getAttribute("item_description"),
			Protein:this.getAttribute("item_protein"),
			Carbohydrate:this.getAttribute("item_carbohydrate")
           };
   fooditems.push(x);
   //alert(fooditems[0].Protein);
   
   alert(fooditems.protein);
   
   var previous_items = localStorage.getItem('added-items');
   //alert(previous_items);
   alert(previous_json);
   var previous_json = JSON.parse(previous_items);
   if(previous_json !== null)
   {
     //alert(previous_json);
     //alert(previous_json[0].Description); 
	 var concated_array	= previous_json.concat(fooditems);
     //alert(concated_array);
	 localStorage.setItem('added-items',JSON.stringify(concated_array));
	 var check = localStorage.getItem('added-items');
	 //alert(check);
   
   }
   else
   {
     localStorage.setItem('added-items', JSON.stringify(fooditems));
   }
   
   
   var json = JSON.parse(localStorage.getItem('added-items'));
   alert(json);
   calculate_items();
   //for(var j=0;j<json.length;j++)
   //{
   // alert(json[j].Protein);
   //}
 };
 
 
 function calculate_items()
 {
    
    var items = JSON.parse(localStorage.getItem('added-items'));
	if(items == null)
	{
	 document.getElementById("total_items").setAttribute("data-badge",0);
    }
	else
	{
	 document.getElementById("total_items").setAttribute("data-badge",items.length); 
	}
 }*/
 
 
 
 
 
 
  
 var fooditems = new Array();	   
		   
 function page_change(value)
 {
    //alert(value);
    //alert("in change");
    localStorage.setItem("page_change",value);
	
 }

 function get_total()
 {
   page_change("1");
   concate_previous();
   window.open("content-ui.html",'_self');
 }
 
 function clear_data()
 {
    localStorage.removeItem('added-items');
	alert("your inventry has been emptied!!");
	page_change("0");
	calculate_items();
 } 

 function itemDesc()
{
     document.getElementById("items").innerHTML = ""; 
     //alert("in function");
     var xhttp = new XMLHttpRequest();
     xhttp.onreadystatechange = function() {
     //alert("inside call");
	 //alert(this.status);
	 if (this.readyState == 4 && this.status == 200) {
      //alert(str[0].Protein);
	  
	 var str = JSON.parse(this.responseText);
	 //alert(document.getElementById("item_name").value);
	 
	 if(document.getElementById("item_name").value == "")
	 {
	    alert("Please enter an item name");
	 }
	 else
	 {
     var patt = new RegExp(document.getElementById("item_name").value);
     var id_item=0;
	 //var r = document.createElement("div");
     //r.id = "container";
      for(var i=0;i<str.length;i++)
	  {
	   var res = patt.test(str[i].Description);
	   //alert(res);
	   
	   if(res)
	   {
	      var y = document.createElement("div");
		  y.className = "items_appended";
		  y.innerHTML = str[i].Description;
		  y.setAttribute("item_id",id_item++);
		  y.setAttribute("item_description",str[i].Description);
		  y.setAttribute("item_Protein",str[i].Protein);
		  y.setAttribute("item_carbohydrate",str[i].Carbohydrate);
		  y.setAttribute("item_energy",str[i].Energy);
		  y.onclick = getName;
		  
		  //r.appendChild(y);
		  //document.getElementById("items").appendChild(y)
		  document.getElementById("items").appendChild(y);
		}
		
	  }
	  //alert(document.getElementById("items").innerHTML);
    }
    }
  };
  xhttp.open("GET", "fooditems.json", true);
  xhttp.send();
}
   
   function getName()
   {
   //alert(this.getAttribute("item_id"));
   //alert(this.getAttribute("item_description"));
   var x = {
            Id:this.getAttribute("item_id"),
            Description:this.getAttribute("item_description"),
			Protein:this.getAttribute("item_protein"),
			Carbohydrate:this.getAttribute("item_carbohydrate"),
			Energy:this.getAttribute("item_energy")
           };
   fooditems.push(x);
   
   //alert(fooditems);
   
   //for(var i=0;i<fooditems.length;i++)
   //{
     //alert(fooditems[i].Description);
   //}
   
   calculate_items();
   
   /*
   //alert(fooditems[0].Protein);
   //if(localStorage.getItem("page_change") == "1")
   //{
   //var previous_items = localStorage.getItem('added-items');
   alert(previous_items);
   
   var previous_json = JSON.parse(previous_items);
   if(previous_json !== null)
   {
     //alert(previous_json);
     //alert(previous_json[0].Description); 
	 var concated_array	= previous_json.concat(fooditems);
     localStorage.setItem('added-items',JSON.stringify(concated_array));
	 var check = localStorage.getItem('added-items');
	 //alert(check);
    }
   else
   {
   localStorage.setItem('added-items', JSON.stringify(fooditems));
   }
   page_change("0");
   //
   //else
   //{
     
	// localStorage.setItem('added-items',JSON.stringify(fooditems));
   //}
   var json = JSON.parse(localStorage.getItem('added-items'));
   for(var j=0;j<json.length;j++)
   {
    alert(json[j].Protein);
   }
   */
  
   
 };
 
 function concate_previous()
 {
    var previous_items = localStorage.getItem('added-items');
   //alert(previous_items);
    if(previous_items!= null)
	{
     var previous_json = JSON.parse(previous_items);
     var concated_array	= previous_json.concat(fooditems);
     localStorage.setItem('added-items',JSON.stringify(concated_array));
	}
    else
    {
	  localStorage.setItem('added-items',JSON.stringify(fooditems));
    } 	
 }
 
 function calculate_items()
 {
    var fooditems_length = fooditems.length;
	var items_length;
    var items = JSON.parse(localStorage.getItem('added-items'));
	if(items == null)
	{
	  items_length = 0;
    }
	else
	{
	 items_length = items.length; 
	}
	
	total_length = fooditems_length + items_length;
	document.getElementById("total_items").setAttribute("data-badge",total_length);
	

 }
 
 function empty_if_null()
 {
    //alert("in empty");
    var check = JSON.parse(localStorage.getItem("added-items"));
	if(check !== null)
	{
     if(check[0] == null)
	 {
	    localStorage.removeItem("added-items");
	    calculate_items();
	 }
	}   
  }
  
  function show_user_info()
  {
      var user_info = JSON.parse(localStorage.getItem("user_info"));
	  document.getElementById("user_name").innerHTML = user_info.name;
	  document.getElementById("user_height").innerHTML = user_info.height_feet+"feet"+user_info.height_inches+"inch";
	  document.getElementById("user_weight").innerHTML = user_info.weight+"kg";
	  document.getElementById("user_goal").innerHTML = user_info.goal;
  }
 
 
</script>	

 
</body>

</html>